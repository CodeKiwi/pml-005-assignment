---
title: "PML-005 prediction assignment"
author: "Josh Bondy"
date: "8 September 2014"
output: html_document
---

This is my prediction assignment for <https://class.coursera.org/predmachlearn-005>.

###Import caret package
For this project we will use the **caret** package, this package smoothes over some of the R quirks when it comes to applying machine learning techniques.

```{r}
library(caret)
library(kernlab)
```

####Load data
```{r}
# For local
setwd("~/Documents/Projects/pml-005-assignment")
input <- read.csv("pml-training.csv")
#input <- read.table('pml-training.csv', header=T, sep=",") 
str(input)

prediction_input <- read.csv("pml-testing.csv",sep=",")

# For submission
#input <- read.csv("http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv")
#prediction_input <- read.csv("https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv")
```

####Clean data
Remove features with low variance and significant NA values
```{r}
input <- input[complete.cases(input),]
nsv <- nearZeroVar(input,saveMetrics=FALSE)
nsv
input <- input[-nsv]
str(input)
```

####Create training and test sets
Split into training and test data, test data to be split into multiple cross validation sets using Kfolds

```{r}
inTrain <- createDataPartition(y=input$classe, p=0.7, list=FALSE)
training <- input[inTrain,]
testing <- input[-inTrain,]
dim(training); dim(testing)
summary(training)
featurePlot(x=training[,c("roll_dumbbell", "pitch_dumbbell","yaw_dumbbell")],y=training$classe, plot="pair")
```

####Fit a model
```{r}
training$classe
set.seed(32343)
#modelFit <- train(classe~ .,data=training,method="rf",prox=TRUE)
modelFit <- randomForest(classe~ ., data=training, ntree=100, mtry=10)

#modelFit <- train(classe ~.,data=training, method="logreg")
warnings()
modelFit
```

####Final model

####Predict test data
```{r}
#testing <- read.csv("pml-testing.csv")
```

####Confusion matrix


```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

